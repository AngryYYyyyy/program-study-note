{"remainingRequest":"I:\\MSB\\msb_hejiayun_work\\jeethink-UI\\jeethink-ui\\jeethink-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!I:\\MSB\\msb_hejiayun_work\\jeethink-UI\\jeethink-ui\\jeethink-ui\\src\\layout\\components\\AppMain.vue?vue&type=script&lang=js&","dependencies":[{"path":"I:\\MSB\\msb_hejiayun_work\\jeethink-UI\\jeethink-ui\\jeethink-ui\\src\\layout\\components\\AppMain.vue","mtime":1615183774631},{"path":"I:\\MSB\\msb_hejiayun_work\\jeethink-UI\\jeethink-ui\\jeethink-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"I:\\MSB\\msb_hejiayun_work\\jeethink-UI\\jeethink-ui\\jeethink-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"I:\\MSB\\msb_hejiayun_work\\jeethink-UI\\jeethink-ui\\jeethink-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"I:\\MSB\\msb_hejiayun_work\\jeethink-UI\\jeethink-ui\\jeethink-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgR2xvYmFsIGZyb20gIkAvbGF5b3V0L2NvbXBvbmVudHMvZ2xvYmFsLmpzIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnQXBwTWFpbicsDQogIGNvbXB1dGVkOiB7DQogICAgbm90Q2FjaGVOYW1lKCkgew0KICAgICAgdmFyIHZpc2l0ZWRWaWV3cyA9IHRoaXMuJHN0b3JlLnN0YXRlLnRhZ3NWaWV3LnZpc2l0ZWRWaWV3czsNCiAgICAgIHZhciBub0NhY2hlVmlld3MgPSBbXTsNCiAgICAgIE9iamVjdC5rZXlzKHZpc2l0ZWRWaWV3cykuc29tZSgoaW5kZXgpID0+IHsNCiAgICAgICAgaWYgKHZpc2l0ZWRWaWV3c1tpbmRleF0ubWV0YS5ub0NhY2hlKSB7DQogICAgICAgICAgbm9DYWNoZVZpZXdzLnB1c2godmlzaXRlZFZpZXdzW2luZGV4XS5uYW1lKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgICByZXR1cm4gbm9DYWNoZVZpZXdzOw0KICAgIH0sDQogICAga2V5KCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHJvdXRlLnBhdGg7DQogICAgfSwNCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICAvLyDlhbPpl63moIfnrb7op6blj5ENCiAgICBHbG9iYWwuJG9uKCJyZW1vdmVDYWNoZSIsIChuYW1lLCB2aWV3KSA9PiB7DQogICAgICB0aGlzLnJlbW92ZUNhY2hlKG5hbWUsIHZpZXcpOw0KICAgIH0pOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8g6I635Y+W5pyJa2VlcC1hbGl2ZeWtkOiKgueCueeahFZub2RlDQogICAgZ2V0Vm5vZGUoKSB7DQogICAgICAvLyDliKTmlq3lrZDpm4bpnZ7nqboNCiAgICAgIGlmICh0aGlzLiRjaGlsZHJlbi5sZW5ndGggPT0gMCkgcmV0dXJuIGZhbHNlOw0KICAgICAgbGV0IHZub2RlOw0KICAgICAgZm9yIChsZXQgaXRlbSBvZiB0aGlzLiRjaGlsZHJlbikgew0KICAgICAgICAvLyDlpoLmnpxkYXRh5Lit5pyJa2V55YiZ5Luj6KGo5om+5Yiw5LqGa2VlcC1hbGl2ZeS4i+mdoueahOWtkOmbhu+8jOi/meS4qmtleeWwseaYr3JvdXRlci12aWV35LiK55qEa2V5DQogICAgICAgIGlmIChpdGVtLiR2bm9kZS5kYXRhLmtleSkgew0KICAgICAgICAgIHZub2RlID0gaXRlbS4kdm5vZGU7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHJldHVybiB2bm9kZSA/IHZub2RlIDogZmFsc2U7DQogICAgfSwNCiAgICAvLyDnp7vpmaRrZWVwLWFsaXZl57yT5a2YDQogICAgcmVtb3ZlQ2FjaGUobmFtZSwgdmlldyA9IHt9KSB7DQogICAgICBsZXQgdm5vZGUgPSB0aGlzLmdldFZub2RlKCk7DQogICAgICBpZiAoIXZub2RlKSByZXR1cm4gZmFsc2U7DQogICAgICBsZXQgY29tcG9uZW50SW5zdGFuY2UgPSB2bm9kZS5wYXJlbnQuY29tcG9uZW50SW5zdGFuY2U7DQogICAgICAvLyDov5nkuKprZXnmmK/nlKjmnaXojrflj5bliY3nvIDnlKjmnaXlkI7pnaLmraPliJnljLnphY3nlKjnmoQNCiAgICAgIGxldCBrZXlTdGFydCA9IHZub2RlLmtleS5zcGxpdCgiLyIpWzBdOw0KICAgICAgbGV0IHRoaXNLZXkgPSBgJHtrZXlTdGFydH0ke3ZpZXcuZnVsbFBhdGh9YDsNCiAgICAgIGxldCByZWdLZXkgPSBgJHtrZXlTdGFydH0ke3ZpZXcucGF0aH1gOw0KDQogICAgICB0aGlzW25hbWVdKHsgY29tcG9uZW50SW5zdGFuY2UsIHRoaXNLZXksIHJlZ0tleSB9KTsNCiAgICB9LA0KICAgIC8vIOenu+mZpOWFtuS7lg0KICAgIGNsb3NlT3RoZXJzVGFncyh7IGNvbXBvbmVudEluc3RhbmNlLCB0aGlzS2V5IH0pIHsNCiAgICAgIE9iamVjdC5rZXlzKGNvbXBvbmVudEluc3RhbmNlLmNhY2hlKS5mb3JFYWNoKChrZXksIGluZGV4KSA9PiB7DQogICAgICAgIGlmIChrZXkgIT0gdGhpc0tleSkgew0KICAgICAgICAgIC8vIOmUgOavgeWunuS+iyjov5nph4zlrZjlnKjlpJrkuKprZXnmjIflkJHkuIDkuKrnvJPlrZjnmoTmg4XlhrXlj6/og73liY3pnaLkuIDkuKrlt7Lnu4/muIXpmaTmjonkuobmiYDmnInopoHliqDliKTmlq0pDQogICAgICAgICAgaWYgKGNvbXBvbmVudEluc3RhbmNlLmNhY2hlW2tleV0pIHsNCiAgICAgICAgICAgIGNvbXBvbmVudEluc3RhbmNlLmNhY2hlW2tleV0uY29tcG9uZW50SW5zdGFuY2UuJGRlc3Ryb3koKTsNCiAgICAgICAgICB9DQogICAgICAgICAgLy8g5Yig6Zmk57yT5a2YDQogICAgICAgICAgZGVsZXRlIGNvbXBvbmVudEluc3RhbmNlLmNhY2hlW2tleV07DQogICAgICAgICAgLy8g56e76Zmka2V55Lit5a+55bqU55qEa2V5DQogICAgICAgICAgY29tcG9uZW50SW5zdGFuY2Uua2V5cy5zcGxpY2UoaW5kZXgsIDEpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICAgIC8vIOenu+mZpOaJgOaciee8k+WtmA0KICAgIGNsb3NlQWxsVGFncyh7IGNvbXBvbmVudEluc3RhbmNlIH0pIHsNCiAgICAgIC8vIOmUgOavgeWunuS+iw0KICAgICAgT2JqZWN0LmtleXMoY29tcG9uZW50SW5zdGFuY2UuY2FjaGUpLmZvckVhY2goKGtleSkgPT4gew0KICAgICAgICBpZiAoY29tcG9uZW50SW5zdGFuY2UuY2FjaGVba2V5XSkgew0KICAgICAgICAgIGNvbXBvbmVudEluc3RhbmNlLmNhY2hlW2tleV0uY29tcG9uZW50SW5zdGFuY2UuJGRlc3Ryb3koKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgICAvLyDliKDpmaTnvJPlrZgNCiAgICAgIGNvbXBvbmVudEluc3RhbmNlLmNhY2hlID0ge307DQogICAgICAvLyDnp7vpmaRrZXnkuK3lr7nlupTnmoRrZXkNCiAgICAgIGNvbXBvbmVudEluc3RhbmNlLmtleXMgPSBbXTsNCiAgICB9LA0KICAgIC8vIOenu+mZpOWNleS4que8k+WtmA0KICAgIGNsb3NlU2VsZWN0ZWRUYWcoeyBjb21wb25lbnRJbnN0YW5jZSwgcmVnS2V5IH0pIHsNCiAgICAgIGxldCByZWcgPSBuZXcgUmVnRXhwKGBeJHtyZWdLZXl9YCk7DQogICAgICBPYmplY3Qua2V5cyhjb21wb25lbnRJbnN0YW5jZS5jYWNoZSkuZm9yRWFjaCgoa2V5LCBpKSA9PiB7DQogICAgICAgIGlmIChyZWcudGVzdChrZXkpKSB7DQogICAgICAgICAgLy8g6ZSA5q+B5a6e5L6LDQogICAgICAgICAgaWYgKGNvbXBvbmVudEluc3RhbmNlLmNhY2hlW2tleV0pIHsNCiAgICAgICAgICAgIGNvbXBvbmVudEluc3RhbmNlLmNhY2hlW2tleV0uY29tcG9uZW50SW5zdGFuY2UuJGRlc3Ryb3koKTsNCiAgICAgICAgICB9DQogICAgICAgICAgLy8g5Yig6Zmk57yT5a2YDQogICAgICAgICAgZGVsZXRlIGNvbXBvbmVudEluc3RhbmNlLmNhY2hlW2tleV07DQogICAgICAgICAgLy8g56e76Zmka2V55Lit5a+55bqU55qEa2V5DQogICAgICAgICAgY29tcG9uZW50SW5zdGFuY2Uua2V5cy5zcGxpY2UoaSwgMSk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0sDQogICAgLy8g5Yi35paw5Y2V5Liq57yT5a2YDQogICAgcmVmcmVzaFNlbGVjdGVkVGFnKHsgY29tcG9uZW50SW5zdGFuY2UsIHRoaXNLZXkgfSkgew0KICAgICAgT2JqZWN0LmtleXMoY29tcG9uZW50SW5zdGFuY2UuY2FjaGUpLmZvckVhY2goKGtleSwgaW5kZXgpID0+IHsNCiAgICAgICAgaWYgKG51bGwgIT0gdGhpc0tleSAmJiBrZXkucmVwbGFjZSgiL3JlZGlyZWN0IiwgIiIpID09IHRoaXNLZXkpIHsNCiAgICAgICAgICAvLyAxIOmUgOavgeWunuS+iyjov5nph4zlrZjlnKjlpJrkuKprZXnmjIflkJHkuIDkuKrnvJPlrZjnmoTmg4XlhrXlj6/og73liY3pnaLkuIDkuKrlt7Lnu4/muIXpmaTmjonkuobmiYDmnInopoHliqDliKTmlq0pDQogICAgICAgICAgaWYgKGNvbXBvbmVudEluc3RhbmNlLmNhY2hlW2tleV0pIHsNCiAgICAgICAgICAgIGNvbXBvbmVudEluc3RhbmNlLmNhY2hlW2tleV0uY29tcG9uZW50SW5zdGFuY2UuJGRlc3Ryb3koKTsNCiAgICAgICAgICB9DQogICAgICAgICAgLy8gMiDliKDpmaTnvJPlrZgNCiAgICAgICAgICBkZWxldGUgY29tcG9uZW50SW5zdGFuY2UuY2FjaGVba2V5XTsNCiAgICAgICAgICAvLyAzIOenu+mZpGtleeS4reWvueW6lOeahGtleQ0KICAgICAgICAgIGNvbXBvbmVudEluc3RhbmNlLmtleXMuc3BsaWNlKGluZGV4LCAxKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["AppMain.vue"],"names":[],"mappings":";;;;;;;;;;;;AAYA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AppMain.vue","sourceRoot":"src/layout/components","sourcesContent":["\r\n<template>\r\n  <section class=\"app-main\">\r\n    <transition name=\"fade-transform\" mode=\"out-in\">\r\n      <keep-alive :max=\"20\" :exclude=\"notCacheName\">\r\n        <router-view :key=\"key\" />\r\n      </keep-alive>\r\n    </transition>\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport Global from \"@/layout/components/global.js\";\r\n\r\nexport default {\r\n  name: 'AppMain',\r\n  computed: {\r\n    notCacheName() {\r\n      var visitedViews = this.$store.state.tagsView.visitedViews;\r\n      var noCacheViews = [];\r\n      Object.keys(visitedViews).some((index) => {\r\n        if (visitedViews[index].meta.noCache) {\r\n          noCacheViews.push(visitedViews[index].name);\r\n        }\r\n      });\r\n      return noCacheViews;\r\n    },\r\n    key() {\r\n      return this.$route.path;\r\n    },\r\n  },\r\n  mounted() {\r\n    // 关闭标签触发\r\n    Global.$on(\"removeCache\", (name, view) => {\r\n      this.removeCache(name, view);\r\n    });\r\n  },\r\n  methods: {\r\n    // 获取有keep-alive子节点的Vnode\r\n    getVnode() {\r\n      // 判断子集非空\r\n      if (this.$children.length == 0) return false;\r\n      let vnode;\r\n      for (let item of this.$children) {\r\n        // 如果data中有key则代表找到了keep-alive下面的子集，这个key就是router-view上的key\r\n        if (item.$vnode.data.key) {\r\n          vnode = item.$vnode;\r\n          break;\r\n        }\r\n      }\r\n      return vnode ? vnode : false;\r\n    },\r\n    // 移除keep-alive缓存\r\n    removeCache(name, view = {}) {\r\n      let vnode = this.getVnode();\r\n      if (!vnode) return false;\r\n      let componentInstance = vnode.parent.componentInstance;\r\n      // 这个key是用来获取前缀用来后面正则匹配用的\r\n      let keyStart = vnode.key.split(\"/\")[0];\r\n      let thisKey = `${keyStart}${view.fullPath}`;\r\n      let regKey = `${keyStart}${view.path}`;\r\n\r\n      this[name]({ componentInstance, thisKey, regKey });\r\n    },\r\n    // 移除其他\r\n    closeOthersTags({ componentInstance, thisKey }) {\r\n      Object.keys(componentInstance.cache).forEach((key, index) => {\r\n        if (key != thisKey) {\r\n          // 销毁实例(这里存在多个key指向一个缓存的情况可能前面一个已经清除掉了所有要加判断)\r\n          if (componentInstance.cache[key]) {\r\n            componentInstance.cache[key].componentInstance.$destroy();\r\n          }\r\n          // 删除缓存\r\n          delete componentInstance.cache[key];\r\n          // 移除key中对应的key\r\n          componentInstance.keys.splice(index, 1);\r\n        }\r\n      });\r\n    },\r\n    // 移除所有缓存\r\n    closeAllTags({ componentInstance }) {\r\n      // 销毁实例\r\n      Object.keys(componentInstance.cache).forEach((key) => {\r\n        if (componentInstance.cache[key]) {\r\n          componentInstance.cache[key].componentInstance.$destroy();\r\n        }\r\n      });\r\n      // 删除缓存\r\n      componentInstance.cache = {};\r\n      // 移除key中对应的key\r\n      componentInstance.keys = [];\r\n    },\r\n    // 移除单个缓存\r\n    closeSelectedTag({ componentInstance, regKey }) {\r\n      let reg = new RegExp(`^${regKey}`);\r\n      Object.keys(componentInstance.cache).forEach((key, i) => {\r\n        if (reg.test(key)) {\r\n          // 销毁实例\r\n          if (componentInstance.cache[key]) {\r\n            componentInstance.cache[key].componentInstance.$destroy();\r\n          }\r\n          // 删除缓存\r\n          delete componentInstance.cache[key];\r\n          // 移除key中对应的key\r\n          componentInstance.keys.splice(i, 1);\r\n        }\r\n      });\r\n    },\r\n    // 刷新单个缓存\r\n    refreshSelectedTag({ componentInstance, thisKey }) {\r\n      Object.keys(componentInstance.cache).forEach((key, index) => {\r\n        if (null != thisKey && key.replace(\"/redirect\", \"\") == thisKey) {\r\n          // 1 销毁实例(这里存在多个key指向一个缓存的情况可能前面一个已经清除掉了所有要加判断)\r\n          if (componentInstance.cache[key]) {\r\n            componentInstance.cache[key].componentInstance.$destroy();\r\n          }\r\n          // 2 删除缓存\r\n          delete componentInstance.cache[key];\r\n          // 3 移除key中对应的key\r\n          componentInstance.keys.splice(index, 1);\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.app-main {\r\n  /* 50= navbar  50  */\r\n  min-height: calc(100vh - 50px);\r\n  width: 100%;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n.fixed-header + .app-main {\r\n  padding-top: 50px;\r\n}\r\n\r\n.hasTagsView {\r\n  .app-main {\r\n    /* 84 = navbar + tags-view = 50 + 34 */\r\n    min-height: calc(100vh - 84px);\r\n  }\r\n\r\n  .fixed-header + .app-main {\r\n    padding-top: 84px;\r\n  }\r\n}\r\n</style>\r\n\r\n<style lang=\"scss\">\r\n// fix css style bug in open el-dialog\r\n.el-popup-parent--hidden {\r\n  .fixed-header {\r\n    padding-right: 15px;\r\n  }\r\n}\r\n</style>\r\n"]}]}